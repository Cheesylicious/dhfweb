<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - DHF-Planer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; background: #f1f5f9; color: #333; }
        header { background: #fff; padding: 15px 30px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        header h1 { margin: 0; color: #0056b3; font-size: 24px; }
        header nav { display: flex; gap: 20px; }
        header nav a { text-decoration: none; color: #333; font-weight: 500; font-size: 16px; padding: 10px; border-radius: 5px; }
        header nav a.active, header nav a:hover { background-color: #f0f5fa; color: #0056b3; }
        #user-info { display: flex; align-items: center; gap: 15px; }
        #logout-btn { background: #e74c3c; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 15px; }
        main { padding: 30px; max-width: 1200px; margin: auto; }
        .card { background: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 30px; }
    </style>
</head>
<body>

    <header>
        <h1>DHF-Planer</h1>
        <nav>
            <a href="dashboard.html" class="active">Dashboard</a>
            <a href="users.html">Benutzerverwaltung</a>
            <a href="schichtplan.html">Schichtplan</a>
        </nav>
        <div id="user-info">
            <span id="welcome-user"></span>
            <button id="logout-btn">Abmelden</button>
        </div>
    </header>

    <main>
        <div class="card">
            <h2>Willkommen!</h2>
            <p>Dies ist das Admin-Dashboard. W채hlen Sie einen Bereich aus der Navigation oben.</p>
        </div>
    </main>

    <script>
        // (Das Basis-Skript f체r Logout und User-Check bleibt unver채ndert)
        const API_URL = 'http://46.224.63.203:5000'; // Ersetzen Sie dies ggf. durch Ihre Domain
        let user;

        async function logout() {
            try {
                await apiFetch('/api/logout', 'POST');
            } catch (error) {
                console.error("Logout-Fehler:", error.message);
            } finally {
                localStorage.removeItem('dhf_user');
                window.location.href = 'index.html?logout=true';
            }
        }

        try {
            user = JSON.parse(localStorage.getItem('dhf_user'));
            if (!user || !user.vorname) { throw new Error("Kein User"); }
            document.getElementById('welcome-user').textContent = `Willkommen, ${user.vorname}!`;
        } catch (e) {
            window.location.href = 'index.html?logout=true';
        }

        document.getElementById('logout-btn').onclick = logout;

        async function apiFetch(endpoint, method = 'GET', body = null) {
            const options = {
                method,
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include'
            };
            if (body) { options.body = JSON.stringify(body); }
            const response = await fetch(API_URL + endpoint, options);
            if (response.status === 401 || response.status === 403) {
                logout();
                throw new Error('Sitzung ung체ltig');
            }
            if (!response.ok) {
                const data = await response.json();
                throw new Error(data.message || 'API-Fehler');
            }
            if (response.status !== 204) {
                try { return await response.json(); } catch(e) { return {}; }
            }
        }
    </script>
</body>
</html>